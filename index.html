<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISO 27001 Â∞éÂÖ•Â∞àÊ°à WBS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.1) 10px,
                rgba(255,255,255,0.1) 20px
            );
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translateX(-50px); }
            100% { transform: translateX(50px); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: white;
            border-radius: 25px;
            padding: 8px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .search-box:focus-within {
            transform: scale(1.02);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .search-box input {
            border: none;
            outline: none;
            padding: 8px;
            font-size: 14px;
            width: 250px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .content {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .wbs-tree {
            font-size: 14px;
            line-height: 1.6;
        }

        .wbs-level-1 {
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
            padding-left: 20px;
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.1), transparent);
            border-radius: 0 10px 10px 0;
        }

        .wbs-level-2 {
            margin: 15px 0;
            padding-left: 20px;
            border-left: 3px solid #2ecc71;
            background: linear-gradient(90deg, rgba(46, 204, 113, 0.08), transparent);
        }

        .wbs-level-3 {
            margin: 10px 0;
            padding-left: 20px;
            border-left: 2px solid #f39c12;
            background: linear-gradient(90deg, rgba(243, 156, 18, 0.06), transparent);
        }

        .wbs-level-4 {
            margin: 8px 0;
            padding-left: 20px;
            color: #666;
            border-left: 1px solid #95a5a6;
        }

        .wbs-item {
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .wbs-item:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: translateX(5px);
        }

        .wbs-code {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .wbs-title {
            font-weight: 500;
        }

        .wbs-level-1 .wbs-code {
            color: #3498db;
            font-size: 1.1em;
        }

        .wbs-level-2 .wbs-code {
            color: #2ecc71;
        }

        .wbs-level-3 .wbs-code {
            color: #f39c12;
        }

        .collapse-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: transform 0.3s ease;
            color: #666;
        }

        .collapse-btn.collapsed {
            transform: rotate(-90deg);
        }

        .stats {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            min-width: 200px;
            z-index: 1000;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .stats-label {
            color: #666;
        }

        .stats-value {
            font-weight: bold;
            color: #2c3e50;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #ecf0f1;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .highlight {
            background: rgba(255, 235, 59, 0.3) !important;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .timeline-view {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .timeline-week {
            font-weight: bold;
            color: #3498db;
            min-width: 80px;
            margin-right: 20px;
        }

        .timeline-content {
            flex: 1;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box input {
                width: 200px;
            }

            .stats {
                position: relative;
                top: auto;
                right: auto;
                margin: 20px auto;
                max-width: 100%;
            }

            .content {
                padding: 20px;
                padding-right: 20px; /* ÊâãÊ©üÁâà‰ΩøÁî®Ê≠£Â∏∏padding */
                max-height: 60vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ISO 27001 Â∞éÂÖ•Â∞àÊ°à</h1>
            <p class="subtitle">Work Breakdown Structure (WBS) | Â∞àÊ°àÊúüÁ®ãÔºö16ÈÄ±</p>
        </div>

        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ÊêúÂ∞ã WBS È†ÖÁõÆ...">
                <span>üîç</span>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="expandAll()">Â±ïÈñãÂÖ®ÈÉ®</button>
                <button class="btn btn-secondary" onclick="collapseAll()">Êî∂ÂêàÂÖ®ÈÉ®</button>
                <button class="btn btn-success" onclick="toggleTimeline()">ÊôÇÁ®ãÊ™¢Ë¶ñ</button>
                <button class="btn btn-primary" onclick="exportData()">ÂåØÂá∫Ë≥áÊñô</button>
            </div>
        </div>

        <div class="content">
            <div id="wbsTree" class="wbs-tree">
                <!-- WBS ÂÖßÂÆπÊúÉÁî± JavaScript ÂãïÊÖãÁîüÊàê -->
            </div>

            <div id="timelineView" class="timeline-view">
                <h3>Â∞àÊ°àÊôÇÁ®ãÊ™¢Ë¶ñ</h3>
                <div id="timelineContent">
                    <!-- ÊôÇÁ®ãÂÖßÂÆπÊúÉÁî± JavaScript ÂãïÊÖãÁîüÊàê -->
                </div>
            </div>
        </div>
    </div>

    <div class="stats">
        <div class="stats-item">
            <span class="stats-label">Á∏ΩÂ∑•‰ΩúÈ†ÖÁõÆ:</span>
            <span class="stats-value" id="totalItems">-</span>
        </div>
        <div class="stats-item">
            <span class="stats-label">‰∏ªË¶ÅÈöéÊÆµ:</span>
            <span class="stats-value" id="mainPhases">-</span>
        </div>
        <div class="stats-item">
            <span class="stats-label">Â∑•‰ΩúÂåÖÊï∏:</span>
            <span class="stats-value" id="workPackages">-</span>
        </div>
        <div class="stats-item">
            <span class="stats-label">ÂÆåÊàêÈÄ≤Â∫¶:</span>
            <span class="stats-value" id="progress">0%</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 25%"></div>
        </div>
    </div>

    <script>
        // Â∞àÊ°àÈñãÂßãÊó•ÊúüË®≠ÂÆö
        const projectStartDate = new Date('2025-08-01');
        
        // Ë®àÁÆóÊó•ÊúüÁöÑËºîÂä©ÂáΩÊï∏  
        function addDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + days);
            return result;
        }
        
        function formatDate(date) {
            return date.toLocaleDateString('zh-TW', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            });
        }
        
        function getWeekDates(weekRange) {
            const weekNum = weekRange.match(/Week (\d+)(?:-(\d+))?/);
            if (!weekNum) return { start: '', end: '', duration: 0 };
            
            const startWeek = parseInt(weekNum[1]);
            const endWeek = weekNum[2] ? parseInt(weekNum[2]) : startWeek;
            
            const startDate = addDays(projectStartDate, (startWeek - 1) * 7);
            const endDate = addDays(projectStartDate, endWeek * 7 - 1);
            const duration = (endWeek - startWeek + 1) * 7;
            
            return {
                start: formatDate(startDate),
                end: formatDate(endDate),
                duration: duration
            };
        }

        // WBS Ë≥áÊñôÁµêÊßã
        const wbsData = {
            "1.0": {
                title: "Â∞àÊ°àÂïüÂãïËàáË¶èÂäÉ",
                weeks: "Week 1-2",
                duration: "2ÈÄ± (14Â§©)",
                children: {
                    "1.1": {
                        title: "Â∞àÊ°àÁÆ°ÁêÜÂª∫Á´ã",
                        duration: "3Â§©",
                        children: {
                            "1.1.1": {
                                title: "Â∞àÊ°àÁ´†Á®ãÂà∂ÂÆö",
                                duration: "0.5Â§©",
                                children: {
                                    "1.1.1.1": { title: "Â∞àÊ°àÁõÆÊ®ôÂÆöÁæ©", duration: "2Â∞èÊôÇ" },
                                    "1.1.1.2": { title: "ÊàêÂäüÊ®ôÊ∫ñË®≠ÂÆö", duration: "1Â∞èÊôÇ" },
                                    "1.1.1.3": { title: "Â∞àÊ°àÁØÑÂúçÁïåÂÆö", duration: "2Â∞èÊôÇ" },
                                    "1.1.1.4": { title: "Âà©ÂÆ≥Èóú‰øÇ‰∫∫Ë≠òÂà•", duration: "1Â∞èÊôÇ" }
                                }
                            },
                            "1.1.2": {
                                title: "Â∞àÊ°àË®àÁï´Âà∂ÂÆö",
                                duration: "1Â§©",
                                children: {
                                    "1.1.2.1": { title: "WBSË©≥Á¥∞ÂàÜËß£", duration: "3Â∞èÊôÇ" },
                                    "1.1.2.2": { title: "ÊôÇÁ®ãË¶èÂäÉ", duration: "2Â∞èÊôÇ" },
                                    "1.1.2.3": { title: "Ë≥áÊ∫êÈÖçÁΩÆË®àÁï´", duration: "2Â∞èÊôÇ" },
                                    "1.1.2.4": { title: "È†êÁÆóÁ∑®Âàó", duration: "1Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "1.2": {
                        title: "ÁµÑÁπîÊ∫ñÂÇô",
                        duration: "4Â§©",
                        children: {
                            "1.2.1": {
                                title: "ISMSÊé®ÂãïÁµÑÁπîÂª∫Á´ã",
                                duration: "1Â§©",
                                children: {
                                    "1.2.1.1": { title: "Êé®ÂãïÂ∞èÁµÑÊàêÁ´ã", duration: "3Â∞èÊôÇ" },
                                    "1.2.1.2": { title: "ËßíËâ≤ËÅ∑Ë≤¨ÂÆöÁæ©", duration: "3Â∞èÊôÇ" },
                                    "1.2.1.3": { title: "Ê±∫Á≠ñÊ©üÂà∂Âª∫Á´ã", duration: "2Â∞èÊôÇ" }
                                }
                            },
                            "1.2.2": {
                                title: "‰∫∫Âì°ÊåáÊ¥æËàáÂüπË®ì",
                                duration: "2Â§©",
                                children: {
                                    "1.2.2.1": { title: "Â∞àÊ°àÁ∂ìÁêÜÊåáÊ¥æ", duration: "2Â∞èÊôÇ" },
                                    "1.2.2.2": { title: "ÊäÄË°ìË≤†Ë≤¨‰∫∫ÊåáÊ¥æ", duration: "2Â∞èÊôÇ" },
                                    "1.2.2.3": { title: "Ê†∏ÂøÉÂúòÈöäÁµÑÂª∫", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "1.3": {
                        title: "ISMSÁØÑÁñáÂÆöÁæ©",
                        duration: "3Â§©",
                        children: {
                            "1.3.1": {
                                title: "ÁµÑÁπîËÑàÁµ°ÂàÜÊûê",
                                duration: "1Â§©",
                                children: {
                                    "1.3.1.1": { title: "ÂÖßÂ§ñÈÉ®Ë≠∞È°åË≠òÂà•", duration: "3Â∞èÊôÇ" },
                                    "1.3.1.2": { title: "Âà©ÂÆ≥Èóú‰øÇ‰∫∫ÈúÄÊ±ÇÂàÜÊûê", duration: "3Â∞èÊôÇ" }
                                }
                            },
                            "1.3.2": {
                                title: "ÁØÑÁñáÈÇäÁïåÂäÉÂÆö",
                                duration: "1Â§©",
                                children: {
                                    "1.3.2.1": { title: "ÁµÑÁπîÈÇäÁïåÂÆöÁæ©", duration: "2Â∞èÊôÇ" },
                                    "1.3.2.2": { title: "ÂØ¶È´îÈÇäÁïåÂÆöÁæ©", duration: "2Â∞èÊôÇ" },
                                    "1.3.2.3": { title: "ÊäÄË°ìÈÇäÁïåÂÆöÁæ©", duration: "2Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            },
            "2.0": {
                title: "ÁèæÊ≥ÅË©ï‰º∞ËàáÂàÜÊûê",
                weeks: "Week 3-4",
                duration: "2ÈÄ± (14Â§©)",
                children: {
                    "2.1": {
                        title: "Ë≥áË®äË≥áÁî¢Áõ§Èªû",
                        duration: "5Â§©",
                        children: {
                            "2.1.1": {
                                title: "Ë≥áÁî¢Ê∏ÖÂÜäÂª∫Á´ã",
                                duration: "2Â§©",
                                children: {
                                    "2.1.1.1": { title: "Á°¨È´îË≥áÁî¢Áõ§Èªû", duration: "4Â∞èÊôÇ" },
                                    "2.1.1.2": { title: "ËªüÈ´îË≥áÁî¢Áõ§Èªû", duration: "4Â∞èÊôÇ" },
                                    "2.1.1.3": { title: "Ë≥áË®äË≥áÁî¢Áõ§Èªû", duration: "4Â∞èÊôÇ" }
                                }
                            },
                            "2.1.2": {
                                title: "Ë≥áÁî¢ÂàÜÈ°ûÂàÜÁ¥ö",
                                duration: "2Â§©",
                                children: {
                                    "2.1.2.1": { title: "Ë≥áÁî¢ÂàÜÈ°ûÊ®ôÊ∫ñÂà∂ÂÆö", duration: "4Â∞èÊôÇ" },
                                    "2.1.2.2": { title: "Ë≥áÁî¢ÈáçË¶ÅÊÄßË©ï‰º∞", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "2.2": {
                        title: "ÁèæË°åÊéßÂà∂Êé™ÊñΩË©ï‰º∞",
                        duration: "6Â§©",
                        children: {
                            "2.2.1": {
                                title: "ÊäÄË°ìÊéßÂà∂Êé™ÊñΩÊ™¢Ë¶ñ",
                                duration: "2Â§©",
                                children: {
                                    "2.2.1.1": { title: "Á∂≤Ë∑ØÂÆâÂÖ®ÊéßÂà∂", duration: "4Â∞èÊôÇ" },
                                    "2.2.1.2": { title: "Á≥ªÁµ±ÂÆâÂÖ®ÊéßÂà∂", duration: "4Â∞èÊôÇ" }
                                }
                            },
                            "2.2.2": {
                                title: "ÁÆ°ÁêÜÊéßÂà∂Êé™ÊñΩÊ™¢Ë¶ñ",
                                duration: "2Â§©",
                                children: {
                                    "2.2.2.1": { title: "ÊîøÁ≠ñÂà∂Â∫¶Ê™¢Ë¶ñ", duration: "6Â∞èÊôÇ" },
                                    "2.2.2.2": { title: "Á®ãÂ∫èÊñá‰ª∂Ê™¢Ë¶ñ", duration: "6Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            },
            "3.0": {
                title: "È¢®Èö™Ë©ï‰º∞ËàáËôïÁêÜ",
                weeks: "Week 5-6",
                duration: "2ÈÄ± (14Â§©)",
                children: {
                    "3.1": {
                        title: "È¢®Èö™Ë©ï‰º∞Ê∫ñÂÇô",
                        duration: "2Â§©",
                        children: {
                            "3.1.1": {
                                title: "È¢®Èö™Ë©ï‰º∞ÊñπÊ≥ïÈÅ∏ÂÆö",
                                duration: "1Â§©",
                                children: {
                                    "3.1.1.1": { title: "Ë©ï‰º∞ÊñπÊ≥ïÁ†îÊûê", duration: "3Â∞èÊôÇ" },
                                    "3.1.1.2": { title: "Ë©ï‰º∞Â∑•ÂÖ∑ÈÅ∏Êìá", duration: "3Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "3.2": {
                        title: "È¢®Èö™Ë≠òÂà•ËàáÂàÜÊûê",
                        duration: "6Â§©",
                        children: {
                            "3.2.1": {
                                title: "Â®ÅËÑÖË≠òÂà•",
                                duration: "2Â§©",
                                children: {
                                    "3.2.1.1": { title: "ÂÖßÈÉ®Â®ÅËÑÖÂàÜÊûê", duration: "6Â∞èÊôÇ" },
                                    "3.2.1.2": { title: "Â§ñÈÉ®Â®ÅËÑÖÂàÜÊûê", duration: "6Â∞èÊôÇ" }
                                }
                            },
                            "3.2.2": {
                                title: "Âº±ÈªûË≠òÂà•",
                                duration: "2Â§©",
                                children: {
                                    "3.2.2.1": { title: "ÊäÄË°ìÂº±ÈªûÊéÉÊèè", duration: "8Â∞èÊôÇ" },
                                    "3.2.2.2": { title: "ÁÆ°ÁêÜÂº±ÈªûÂàÜÊûê", duration: "8Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "3.3": {
                        title: "ÈÅ©Áî®ÊÄßËÅ≤ÊòéÊõ∏Âà∂ÂÆö",
                        duration: "4Â§©",
                        children: {
                            "3.3.1": {
                                title: "ÊéßÂà∂Êé™ÊñΩÈÅ∏Êìá",
                                duration: "2Â§©",
                                children: {
                                    "3.3.1.1": { title: "ISO 27001ÈôÑÈåÑAÂàÜÊûê", duration: "8Â∞èÊôÇ" },
                                    "3.3.1.2": { title: "ÈÅ©Áî®ÊéßÂà∂Êé™ÊñΩÈÅ∏ÂÆö", duration: "8Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            },
            "4.0": {
                title: "ÊéßÂà∂Êé™ÊñΩË¶èÂäÉËàáË®≠Ë®à",
                weeks: "Week 7-8",
                duration: "2ÈÄ± (14Â§©)",
                children: {
                    "4.1": {
                        title: "Ë≥áË®äÂÆâÂÖ®ÊîøÁ≠ñÂà∂ÂÆö",
                        duration: "5Â§©",
                        children: {
                            "4.1.1": {
                                title: "Ê†∏ÂøÉÊîøÁ≠ñÂà∂ÂÆö",
                                duration: "3Â§©",
                                children: {
                                    "4.1.1.1": { title: "Ë≥áË®äÂÆâÂÖ®ÊîøÁ≠ñ", duration: "8Â∞èÊôÇ" },
                                    "4.1.1.2": { title: "Â≠òÂèñÊéßÂà∂ÊîøÁ≠ñ", duration: "8Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "4.2": {
                        title: "ÊäÄË°ìÊéßÂà∂Êé™ÊñΩË®≠Ë®à",
                        duration: "7Â§©",
                        children: {
                            "4.2.1": {
                                title: "Â≠òÂèñÊéßÂà∂Ë®≠Ë®à",
                                duration: "3Â§©",
                                children: {
                                    "4.2.1.1": { title: "Ë∫´ÂàÜË™çË≠âÊ©üÂà∂", duration: "8Â∞èÊôÇ" },
                                    "4.2.1.2": { title: "ÊéàÊ¨äÁÆ°ÁêÜÊ©üÂà∂", duration: "8Â∞èÊôÇ" }
                                }
                            },
                            "4.2.2": {
                                title: "Á∂≤Ë∑ØÂÆâÂÖ®Ë®≠Ë®à",
                                duration: "2Â§©",
                                children: {
                                    "4.2.2.1": { title: "Á∂≤Ë∑ØÂàÜÊÆµË®≠Ë®à", duration: "8Â∞èÊôÇ" },
                                    "4.2.2.2": { title: "Èò≤ÁÅ´ÁâÜÊîøÁ≠ñË®≠Ë®à", duration: "8Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            },
            "5.0": {
                title: "ÂØ¶ÊñΩËàáÈÉ®ÁΩ≤",
                weeks: "Week 9-12",
                duration: "4ÈÄ± (28Â§©)",
                children: {
                    "5.1": {
                        title: "ÊäÄË°ìÊéßÂà∂Êé™ÊñΩÂØ¶ÊñΩ",
                        duration: "14Â§©",
                        children: {
                            "5.1.1": {
                                title: "Á∂≤Ë∑ØÂÆâÂÖ®Âº∑Âåñ",
                                duration: "5Â§©",
                                children: {
                                    "5.1.1.1": { title: "Èò≤ÁÅ´ÁâÜË¶èÂâáÂÑ™Âåñ", duration: "2Â§©" },
                                    "5.1.1.2": { title: "ÂÖ•‰æµÂÅµÊ∏¨Á≥ªÁµ±ÈÉ®ÁΩ≤", duration: "2Â§©" }
                                }
                            },
                            "5.1.2": {
                                title: "Á≥ªÁµ±ÂÆâÂÖ®Âº∑Âåñ",
                                duration: "5Â§©",
                                children: {
                                    "5.1.2.1": { title: "Á≥ªÁµ±Âº∑ÂåñË®≠ÂÆö", duration: "2Â§©" },
                                    "5.1.2.2": { title: "Èò≤ÊØíËªüÈ´îÈÉ®ÁΩ≤", duration: "1Â§©" }
                                }
                            }
                        }
                    },
                    "5.2": {
                        title: "ÁÆ°ÁêÜÊéßÂà∂Êé™ÊñΩÂØ¶ÊñΩ",
                        duration: "8Â§©",
                        children: {
                            "5.2.1": {
                                title: "ÊîøÁ≠ñÁ®ãÂ∫èÁôºÂ∏É",
                                duration: "3Â§©",
                                children: {
                                    "5.2.1.1": { title: "ÊîøÁ≠ñÊ≠£ÂºèÁôºÂ∏É", duration: "1Â§©" },
                                    "5.2.1.2": { title: "Á®ãÂ∫èÊìç‰ΩúÊâãÂÜä", duration: "2Â§©" }
                                }
                            },
                            "5.2.2": {
                                title: "ÊïôËÇ≤Ë®ìÁ∑¥Âü∑Ë°å",
                                duration: "3Â§©",
                                children: {
                                    "5.2.2.1": { title: "È´òÈöé‰∏ªÁÆ°Ë®ìÁ∑¥", duration: "0.5Â§©" },
                                    "5.2.2.2": { title: "‰∏ÄËà¨Âì°Â∑•Ë®ìÁ∑¥", duration: "1.5Â§©" }
                                }
                            }
                        }
                    }
                }
            },
            "6.0": {
                title: "Áõ£ÊéßËàáÈáèÊ∏¨",
                weeks: "Week 13-14",
                duration: "2ÈÄ± (14Â§©)",
                children: {
                    "6.1": {
                        title: "Áõ£ÊéßÊ©üÂà∂Âª∫Á´ã",
                        duration: "8Â§©",
                        children: {
                            "6.1.1": {
                                title: "ÊäÄË°ìÁõ£ÊéßÊ©üÂà∂",
                                duration: "5Â§©",
                                children: {
                                    "6.1.1.1": { title: "SIEMÁ≥ªÁµ±ÈÉ®ÁΩ≤", duration: "2Â§©" },
                                    "6.1.1.2": { title: "ÂÆâÂÖ®‰∫ã‰ª∂Áõ£Êéß", duration: "2Â§©" }
                                }
                            }
                        }
                    },
                    "6.2": {
                        title: "Ë©¶ÈÅãË°åËàáÊ∏¨Ë©¶",
                        duration: "6Â§©",
                        children: {
                            "6.2.1": {
                                title: "ÊéßÂà∂Êé™ÊñΩÊ∏¨Ë©¶",
                                duration: "3Â§©",
                                children: {
                                    "6.2.1.1": { title: "ÊäÄË°ìÊéßÂà∂Ê∏¨Ë©¶", duration: "1Â§©" },
                                    "6.2.1.2": { title: "ÁÆ°ÁêÜÊéßÂà∂Ê∏¨Ë©¶", duration: "1Â§©" }
                                }
                            }
                        }
                    }
                }
            },
            "7.0": {
                title: "ÂÖßÈÉ®Á®ΩÊ†∏",
                weeks: "Week 15",
                duration: "1ÈÄ± (7Â§©)",
                children: {
                    "7.1": {
                        title: "ÂÖßÁ®ΩÊ∫ñÂÇô",
                        duration: "2Â§©",
                        children: {
                            "7.1.1": {
                                title: "Á®ΩÊ†∏Ë®àÁï´Âà∂ÂÆö",
                                duration: "1Â§©",
                                children: {
                                    "7.1.1.1": { title: "Á®ΩÊ†∏ÁØÑÂúçÂÆöÁæ©", duration: "4Â∞èÊôÇ" },
                                    "7.1.1.2": { title: "Á®ΩÊ†∏ÊôÇÁ®ãÂÆâÊéí", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "7.2": {
                        title: "ÂÖßÁ®ΩÂü∑Ë°å",
                        duration: "3Â§©",
                        children: {
                            "7.2.1": {
                                title: "Êñá‰ª∂ÂØ©Êü•",
                                duration: "1Â§©",
                                children: {
                                    "7.2.1.1": { title: "ÊîøÁ≠ñÊñá‰ª∂ÂØ©Êü•", duration: "4Â∞èÊôÇ" },
                                    "7.2.1.2": { title: "Á®ãÂ∫èÊñá‰ª∂ÂØ©Êü•", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "7.3": {
                        title: "ÂÖßÁ®ΩÂ†±Âëä",
                        duration: "2Â§©",
                        children: {
                            "7.3.1": {
                                title: "Á®ΩÊ†∏Â†±ÂëäÊí∞ÂØ´",
                                duration: "1Â§©",
                                children: {
                                    "7.3.1.1": { title: "ÁôºÁèæ‰∫ãÈ†ÖÊï¥ÁêÜ", duration: "4Â∞èÊôÇ" },
                                    "7.3.1.2": { title: "Â†±ÂëäÊõ∏Êí∞ÂØ´", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            },
            "8.0": {
                title: "ÁÆ°ÁêÜÂØ©Êü•ËàáÈ©óË≠âÊ∫ñÂÇô",
                weeks: "Week 16",
                duration: "1ÈÄ± (7Â§©)",
                children: {
                    "8.1": {
                        title: "ÁÆ°ÁêÜÂØ©Êü•Âü∑Ë°å",
                        duration: "3Â§©",
                        children: {
                            "8.1.1": {
                                title: "ÁÆ°ÂØ©Ë≥áÊñôÊ∫ñÂÇô",
                                duration: "2Â§©",
                                children: {
                                    "8.1.1.1": { title: "Á∏æÊïàÂ†±ÂëäÂΩôÊï¥", duration: "4Â∞èÊôÇ" },
                                    "8.1.1.2": { title: "ÊîπÂñÑÂª∫Ë≠∞Êï¥ÁêÜ", duration: "4Â∞èÊôÇ" }
                                }
                            }
                        }
                    },
                    "8.2": {
                        title: "Á¨¨‰∏âÊñπÈ©óË≠âÊ∫ñÂÇô",
                        duration: "4Â§©",
                        children: {
                            "8.2.1": {
                                title: "È©óË≠âÊñá‰ª∂Ê∫ñÂÇô",
                                duration: "2Â§©",
                                children: {
                                    "8.2.1.1": { title: "Êñá‰ª∂ÂÆåÊï¥ÊÄßÊ™¢Êü•", duration: "8Â∞èÊôÇ" },
                                    "8.2.1.2": { title: "Ë≠âÊìöË≥áÊñôÊï¥ÁêÜ", duration: "8Â∞èÊôÇ" }
                                }
                            }
                        }
                    }
                }
            }
        };

        // Â±ïÈñã/Êî∂ÂêàÂäüËÉΩ
        function toggleCollapse(btn) {
            const isCollapsed = btn.classList.contains('collapsed');
            const parentItem = btn.closest('.wbs-level-1, .wbs-level-2, .wbs-level-3');
            const childContainer = parentItem.querySelector('.wbs-children');
            
            if (childContainer) {
                if (isCollapsed) {
                    btn.classList.remove('collapsed');
                    btn.textContent = '‚ñº';
                    childContainer.style.display = 'block';
                } else {
                    btn.classList.add('collapsed');
                    btn.textContent = '‚ñ∂';
                    childContainer.style.display = 'none';
                }
            }
        }

        // Â±ïÈñãÂÖ®ÈÉ®
        function expandAll() {
            const buttons = document.querySelectorAll('.collapse-btn');
            buttons.forEach(btn => {
                btn.classList.remove('collapsed');
                btn.textContent = '‚ñº';
                const parentItem = btn.closest('.wbs-level-1, .wbs-level-2, .wbs-level-3');
                const childContainer = parentItem ? parentItem.querySelector('.wbs-children') : null;
                if (childContainer) {
                    childContainer.style.display = 'block';
                }
            });
        }

        // Êî∂ÂêàÂÖ®ÈÉ®
        function collapseAll() {
            const buttons = document.querySelectorAll('.collapse-btn');
            buttons.forEach(btn => {
                btn.classList.add('collapsed');
                btn.textContent = '‚ñ∂';
                const parentItem = btn.closest('.wbs-level-1, .wbs-level-2, .wbs-level-3');
                const childContainer = parentItem ? parentItem.querySelector('.wbs-children') : null;
                if (childContainer) {
                    childContainer.style.display = 'none';
                }
            });
        }

        // ÊôÇÁ®ãÊ™¢Ë¶ñÂàáÊèõ
        function toggleTimeline() {
            const wbsTree = document.getElementById('wbsTree');
            const timelineView = document.getElementById('timelineView');
            
            if (timelineView.style.display === 'none' || timelineView.style.display === '') {
                wbsTree.style.display = 'none';
                timelineView.style.display = 'block';
                renderTimeline();
            } else {
                wbsTree.style.display = 'block';
                timelineView.style.display = 'none';
            }
        }

        // ÂåØÂá∫Ë≥áÊñôÂäüËÉΩ
        function exportData() {
            let exportText = 'ISO 27001 Â∞éÂÖ•Â∞àÊ°à WBS\n';
            exportText += '='.repeat(50) + '\n';
            exportText += 'Â∞àÊ°àÊúüÈñìÔºö' + formatDate(projectStartDate) + ' ~ ' + formatDate(addDays(projectStartDate, 112)) + '\n';
            exportText += 'Á∏ΩÂ∑•ÊúüÔºö112Â§© (16ÈÄ±)\n\n';
            
            function exportLevel(data, level) {
                level = level || 0;
                const indent = '  '.repeat(level);
                Object.keys(data).forEach(key => {
                    const item = data[key];
                    if (typeof item === 'object' && item.title) {
                        let line = indent + key + ' ' + item.title;
                        if (item.duration) {
                            line += ' [' + item.duration + ']';
                        }
                        if (item.weeks) {
                            const dateInfo = getWeekDates(item.weeks);
                            line += ' (' + dateInfo.start + ' ~ ' + dateInfo.end + ')';
                        }
                        exportText += line + '\n';
                        if (item.children) {
                            exportLevel(item.children, level + 1);
                        }
                    }
                });
            }
            
            exportLevel(wbsData);
            
            // ÂâµÂª∫‰∏ãËºâÈÄ£Áµê
            const blob = new Blob([exportText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ISO27001_WBS_' + new Date().toISOString().slice(0,10) + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // ÂâµÂª∫ WBS ÂÖÉÁ¥†
        function createWBSElement(code, item, level) {
            const div = document.createElement('div');
            div.className = 'wbs-level-' + level;
            
            const itemDiv = document.createElement('div');
            itemDiv.className = 'wbs-item';
            itemDiv.dataset.code = code;
            
            let html = '';
            
            // Â¶ÇÊûúÊúâÂ≠êÈ†ÖÁõÆÔºåÊ∑ªÂä†Â±ïÈñã/Êî∂ÂêàÊåâÈàï
            if (item.children) {
                html += '<button class="collapse-btn" onclick="toggleCollapse(this)">‚ñº</button>';
            }
            
            html += '<span class="wbs-code">' + code + '</span>';
            html += '<span class="wbs-title">' + item.title + '</span>';
            
            // Ê∑ªÂä†ÊôÇÁ®ãÂíåÊó•ÊúüË≥áË®ä
            if (item.weeks) {
                const dateInfo = getWeekDates(item.weeks);
                html += ' <span style="color: #666; font-size: 0.85em; margin-left: 10px;">(' + item.weeks + ' | ' + item.duration + ' | ' + dateInfo.start + ' ~ ' + dateInfo.end + ')</span>';
            } else if (item.duration) {
                html += ' <span style="color: #888; font-size: 0.8em; margin-left: 10px;">[' + item.duration + ']</span>';
            }
            
            itemDiv.innerHTML = html;
            div.appendChild(itemDiv);
            
            // Ê∑ªÂä†Â≠êÈ†ÖÁõÆ
            if (item.children) {
                const childContainer = document.createElement('div');
                childContainer.className = 'wbs-children';
                
                Object.keys(item.children).forEach(childKey => {
                    const childItem = item.children[childKey];
                    let childElement;
                    
                    if (typeof childItem === 'object' && childItem.title) {
                        // Êúâ title Â±¨ÊÄßÁöÑÁâ©‰ª∂
                        childElement = createWBSElement(childKey, childItem, level + 1);
                    }
                    
                    if (childElement) {
                        childContainer.appendChild(childElement);
                    }
                });
                
                div.appendChild(childContainer);
            }
            
            return div;
        }

        // Ê∏≤Êüì WBS Ê®πÁãÄÁµêÊßã
        function renderWBS() {
            const container = document.getElementById('wbsTree');
            container.innerHTML = '';
            
            Object.keys(wbsData).forEach(key => {
                const item = wbsData[key];
                const element = createWBSElement(key, item, 1);
                container.appendChild(element);
            });
        }

        // Ê∏≤ÊüìÊôÇÁ®ãÊ™¢Ë¶ñ
        function renderTimeline() {
            const container = document.getElementById('timelineContent');
            
            const timelineData = [
                { 
                    week: "Week 1-2", 
                    phase: "Â∞àÊ°àÂïüÂãïËàáË¶èÂäÉ", 
                    duration: "14Â§©",
                    startDate: "2025/08/01",
                    endDate: "2025/08/14",
                    tasks: ["Â∞àÊ°àÁ´†Á®ãÂà∂ÂÆö (0.5Â§©)", "ISMSÊé®ÂãïÁµÑÁπîÂª∫Á´ã (1Â§©)", "ÁØÑÁñáÈÇäÁïåÂäÉÂÆö (1Â§©)"],
                    totalDays: 10
                },
                { 
                    week: "Week 3-4", 
                    phase: "ÁèæÊ≥ÅË©ï‰º∞ËàáÂàÜÊûê", 
                    duration: "14Â§©",
                    startDate: "2025/08/15",
                    endDate: "2025/08/28",
                    tasks: ["Ë≥áË®äË≥áÁî¢Áõ§Èªû (5Â§©)", "ÁèæË°åÊéßÂà∂Êé™ÊñΩË©ï‰º∞ (6Â§©)", "Ê≥ïË¶èÈÅµÂæ™Ë©ï‰º∞ (3Â§©)"],
                    totalDays: 14
                },
                { 
                    week: "Week 5-6", 
                    phase: "È¢®Èö™Ë©ï‰º∞ËàáËôïÁêÜ", 
                    duration: "14Â§©",
                    startDate: "2025/08/29",
                    endDate: "2025/09/11",
                    tasks: ["È¢®Èö™Ë©ï‰º∞Ê∫ñÂÇô (2Â§©)", "È¢®Èö™Ë≠òÂà•ËàáÂàÜÊûê (6Â§©)", "ÈÅ©Áî®ÊÄßËÅ≤ÊòéÊõ∏Âà∂ÂÆö (4Â§©)"],
                    totalDays: 12
                },
                { 
                    week: "Week 7-8", 
                    phase: "ÊéßÂà∂Êé™ÊñΩË¶èÂäÉËàáË®≠Ë®à", 
                    duration: "14Â§©",
                    startDate: "2025/09/12",
                    endDate: "2025/09/25",
                    tasks: ["Ë≥áË®äÂÆâÂÖ®ÊîøÁ≠ñÂà∂ÂÆö (5Â§©)", "ÊäÄË°ìÊéßÂà∂Êé™ÊñΩË®≠Ë®à (7Â§©)", "ÁÆ°ÁêÜÁ®ãÂ∫èÂª∫Á´ã (2Â§©)"],
                    totalDays: 12
                },
                { 
                    week: "Week 9-12", 
                    phase: "ÂØ¶ÊñΩËàáÈÉ®ÁΩ≤", 
                    duration: "28Â§©",
                    startDate: "2025/09/26",
                    endDate: "2025/10/23",
                    tasks: ["ÊäÄË°ìÊéßÂà∂Êé™ÊñΩÂØ¶ÊñΩ (14Â§©)", "ÁÆ°ÁêÜÊéßÂà∂Êé™ÊñΩÂØ¶ÊñΩ (8Â§©)", "ÂØ¶È´îÊéßÂà∂Êé™ÊñΩÂØ¶ÊñΩ (6Â§©)"],
                    totalDays: 28
                },
                { 
                    week: "Week 13-14", 
                    phase: "Áõ£ÊéßËàáÈáèÊ∏¨", 
                    duration: "14Â§©",
                    startDate: "2025/10/24",
                    endDate: "2025/11/06",
                    tasks: ["Áõ£ÊéßÊ©üÂà∂Âª∫Á´ã (8Â§©)", "Ë©¶ÈÅãË°åËàáÊ∏¨Ë©¶ (6Â§©)", "KPIÊåáÊ®ôÂª∫Á´ã (‰∏¶Ë°å)"],
                    totalDays: 14
                },
                { 
                    week: "Week 15", 
                    phase: "ÂÖßÈÉ®Á®ΩÊ†∏", 
                    duration: "7Â§©",
                    startDate: "2025/11/07",
                    endDate: "2025/11/13",
                    tasks: ["ÂÖßÁ®ΩÊ∫ñÂÇô (2Â§©)", "ÂÖßÁ®ΩÂü∑Ë°å (3Â§©)", "ÂÖßÁ®ΩÂ†±Âëä (2Â§©)"],
                    totalDays: 7
                },
                { 
                    week: "Week 16", 
                    phase: "ÁÆ°ÁêÜÂØ©Êü•ËàáÈ©óË≠âÊ∫ñÂÇô", 
                    duration: "7Â§©",
                    startDate: "2025/11/14",
                    endDate: "2025/11/20",
                    tasks: ["ÁÆ°ÁêÜÂØ©Êü•Âü∑Ë°å (3Â§©)", "Á¨¨‰∏âÊñπÈ©óË≠âÊ∫ñÂÇô (4Â§©)", "Êñá‰ª∂ÊúÄÁµÇÊ™¢Êü• (‰∏¶Ë°å)"],
                    totalDays: 7
                }
            ];
            
            container.innerHTML = '<div style="margin-bottom: 20px;"><h4>Â∞àÊ°àÁ∏ΩË¶Ω</h4><div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;"><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;"><div><strong>Â∞àÊ°àÈñãÂßãÔºö</strong>' + formatDate(projectStartDate) + '</div><div><strong>È†êË®àÂÆåÊàêÔºö</strong>' + formatDate(addDays(projectStartDate, 112)) + '</div><div><strong>Á∏ΩÂ∑•ÊúüÔºö</strong>112Â§© (16ÈÄ±)</div><div><strong>Â∑•‰ΩúÂ§©Ôºö</strong>Á¥Ñ80Â§©</div></div></div></div>';
            
            timelineData.forEach(item => {
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                
                const progressWidth = Math.min((item.totalDays / 28) * 100, 100);
                
                timelineItem.innerHTML = '<div class="timeline-week">' + item.week + '</div><div class="timeline-content"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;"><h4 style="margin: 0; color: #2c3e50;">' + item.phase + '</h4><span style="color: #666; font-size: 0.9em; font-weight: bold;">' + item.duration + '</span></div><div style="font-size: 0.85em; color: #666; margin-bottom: 10px;">üìÖ ' + item.startDate + ' ~ ' + item.endDate + ' | ‚è±Ô∏è ' + item.totalDays + 'Â§©</div><ul style="margin: 10px 0; padding-left: 20px;">' + item.tasks.map(task => '<li style="margin-bottom: 5px;">' + task + '</li>').join('') + '</ul><div style="background: #ecf0f1; height: 8px; border-radius: 4px; overflow: hidden; margin-top: 10px;"><div style="background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: ' + progressWidth + '%; border-radius: 4px; transition: width 0.3s ease;"></div></div></div>';
                
                container.appendChild(timelineItem);
            });
        }

        // Êõ¥Êñ∞Áµ±Ë®àË≥áË®ä
        function updateStats() {
            let totalItems = 0;
            let mainPhases = 0;
            let workPackages = 0;
            
            function countItems(data, level) {
                level = level || 1;
                Object.keys(data).forEach(key => {
                    const item = data[key];
                    totalItems++;
                    
                    if (level === 1) {
                        mainPhases++;
                    } else if (level === 2) {
                        workPackages++;
                    }
                    
                    if (item.children) {
                        countItems(item.children, level + 1);
                    }
                });
            }
            
            countItems(wbsData);
            
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('mainPhases').textContent = mainPhases;
            document.getElementById('workPackages').textContent = workPackages;
        }

        // ÊêúÂ∞ãÂäüËÉΩ
        function setupEventListeners() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                searchWBS(searchTerm);
            });
        }

        function searchWBS(searchTerm) {
            const allItems = document.querySelectorAll('.wbs-item');
            allItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                if (searchTerm === '' || text.includes(searchTerm)) {
                    item.classList.remove('highlight');
                    if (searchTerm !== '' && text.includes(searchTerm)) {
                        item.classList.add('highlight');
                    }
                    item.style.display = 'block';
                } else {
                    item.classList.remove('highlight');
                }
            });
        }

        // Êõ¥Êñ∞Â∞àÊ°àÊó•ÊúüË≥áË®ä
        function updateProjectDates() {
            const projectEndDate = addDays(projectStartDate, 16 * 7 - 1);
            document.querySelector('.subtitle').innerHTML = 'Work Breakdown Structure (WBS) | Â∞àÊ°àÊúüÁ®ãÔºö16ÈÄ±<br><small style="font-size: 0.9em; opacity: 0.8;">Â∞àÊ°àÊúüÈñìÔºö' + formatDate(projectStartDate) + ' ~ ' + formatDate(projectEndDate) + ' | Á∏ΩÂ∑•ÊúüÔºö112Â§©</small>';
        }

        // ÂàùÂßãÂåñÈ†ÅÈù¢
        function initializePage() {
            renderWBS();
            updateStats();
            setupEventListeners();
            updateProjectDates();
        }

        // È†ÅÈù¢ËºâÂÖ•ÂÆåÊàêÂæåÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>
